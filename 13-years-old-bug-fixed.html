<!DOCTYPE html>

<html dir="rtl" lang="fa">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width initial-scale=1" />
  <meta name="keywords" content="کامپیوتر، برنامه‌نویسی، پایتون، علم" />
  <meta name="author" content="Mehdi Sadeghi" />
  <meta name="copyright" content="Commons Attribution 4.0 International" />
  <meta name="robot" content="" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="description" content="سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام."><title>باگ سیزده ساله تعمیر شد - مهدی صادقی</title><link rel="stylesheet" href="http://mehdix.ir/assets/css/main.css">
  <link rel="canonical" href="">
  <link rel="icon" href="http://mehdix.ir/assets/img/me.png"> 
</head>


<body>
  <div class="container">

    <header class="site-header">
  <div class="wrapper">
    <a class="site-title" href="http://mehdix.ir/">مهدی صادقی</a>
    <small> در مورد نرم‌افزار و ایده‌هایم </small>
    <!--nav class="site-nav">
        <a href="#" class="menu-icon">
          <svg viewBox="0 0 18 15">
            <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
            <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
            <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
          </svg>
        </a>
        
        
        <div class="trigger">
          <a class="page-link" href="/404.html">خطای ۴۰۴</a>
        </div>
      </nav>
  </div-->
</header>



    <section class="content">
      <div class="page-content">
        <div class="wrapper"><div class="post">

  <header class="post-header">
    <h1 class="post-title">باگ سیزده ساله تعمیر شد</h1>
    <p class="post-meta"><span class="date">شنبه ۱۹ فروردین ۱۳۹۶</span><!--span></span--></p>
  </header>

  <article class="post-content">
    <p>در مطلب قبلی در مورد باگ GTK و تلاشم برای مرج کردن آن نوشته بودم. الان قصد دارم نتیجه‌ی چند ماه دوندگی و همکاری آنلاین را بنویسم.</p>

<p>ماجرا به طور خلاصه این بود که من از مدتها پیش موقع تایپ فارسی در <code dir="ltr">gedit</code> و <code dir="ltr">zim</code> متوجه شده بودم که اگر کلید کنترل را نگه دارم و به چپ و راست حرکت کنم، نشانگر تایپ در جهت عکس حرکت می‌کند. مثل خیلی از آدم‌ها من هم منتظر شدم تا باگ توسط کس دیگری رفع بشود ولی نشد. در مرحله بعدی سعی کردم مشکل را پیدا و گزارش کنم که به ‏<a href="https://bugzilla.gnome.org/show_bug.cgi?id=136059">این باگ</a> رسیدم. تاریخ باگ را نگاه کنید، سال ۲۰۰۴ ثبت شده است. آن موقع (سال ۲۰۱۵ یا ۱۳۹۴) کل همت من به نوشتن <a href="https://bugzilla.gnome.org/show_bug.cgi?id=136059#c31">یک کامنت</a> خلاصه شد. اینکه بگویم من هم این مشکل را دارم، بلکه کسی دلش به حالم بسوزد و از وقت خودش بزند و بیاید مشکل من را حل بکند!</p>

<p>خب، ولی کسی دلش نسوخت.</p>

<p>اگر باگ را دنبال کنید مراحل بعدی را خودتان می‌بینید. بعد از گذشت یکسال دوباره همتم را جمع کردم و اینبار تصمیم گرفتم خودم باگ را درست کنم. با صرف چند روز وقت و سرو کله زدن با GTK و C پچی درست کردم و باگ را با حل کردم که شرحش را در مطلب قبلی آوردم. ولی مهمترین قسمت کار دنبال کردن باگ است. اگر به کامنت‌ها نگاه کنید و به کسانی که باگ‌های مشابه را ثبت کرده‌اند یا این باگ را دنبال کرده‌اند، متوجه می‌شوید که بیشتر افراد آن را دنبال نمی‌کنند و فیدبک نمی‌دهند. کامنت‌های حاوی اطلاعات روشن و مورد نیاز هم کم است. یعنی افراد (مثل خود من قبلا) کامنت می‌گذارند ولی کامنتشان کم ارزش است چون حاوی اطلاعات به درد بخور نیست و کاری هم برای آن انجام نشده است. ولی اگر کسی برنامه را تست بکند و فیدبک بدهد یا پچ را امتحان بکند و خلاصه به طریقی به پیشرفت پروسه‌ی رفع باگ کمک بکند کارش با ارزش است، در غیر اینصورت کسی توجهی به کامنتش نمی‌کند. و احتمالا جوابی هم دریافت نمی‌کند. در این مورد خواندن مقاله‌ی اریک ریموند بسیار سودمند است. اینکه <a href="http://www.catb.org/esr/faqs/smart-questions.html">چطور از هکرها هوشمندانه سوال بپرسیم</a>. جان کلام اینست که پیام باید نشانگر تلاش سوال کننده در جهت حل مشکل باشد (باید مشق شب خودت را انجام داده باشی)، گویا باشد، طلبکارانه نباشد و برای وقت پاسخ‌دهندگان ارزش قائل باشد. در ضمن باید گفتگو را دنبال کرد و در صورت نیاز با اطلاعات دوباره آن را بروزرسانی کرد. اگر پرسشی پرسیده شده باید به سرعت و دقت پاسخ داده بشود و مانند اینها.</p>

<p>در نهایت بعد از گذشت چند ماه و پیگیری دائمی و رد و بدل کردن چندین و چند پچ و مشارکت عده‌ای از برنامه‌نویسان GTK بالاخره ‬<a href="https://git.gnome.org/browse/gtk+/commit/?id=0128b8d33f47c9387ee342a1158f3038e02eff49">پچ نهایی</a> در مخزن اصلی مرج شد و باگ مورد بحث بعد از گذشت ۱۳ سال فیکس شد. در این مدت دوستم آیدین غریب‌نواز به عنوان کاربر RTL با تست پچ صحت آن را تایید کرد و کامنت گذاشت و دو نفر از برنامه‌نویسان GTK بنام Daniel Bolse و Nelson Benítez León همکاری زیادی برای تولید پچ نهایی کردند.</p>

<p>به این صورت بعد از مدتی اندک اندک با ریلیزهای بعدی گنوم و GTK این پچ منتشر می‌شود و دیستروها هم در نسخه‌های بعدی‌شان آنرا دریافت خواهند کرد. نکته مهمی که طی فرآیند تعمیر این باگ فهمیدیم این بود که از سیزده سال پیش تا به امروز GTK تغییرات زیادی کرده است و این باگ به تنهایی مشکل gedit را حل نمی‌کند چرا که امروز gedit دیگر از GtkTextView (که تعمیرش کردیم) برای نمایش متن استفاده نمی‌کند و بجای آن از یک ویجت دیگر بنام GtkSourceView استفاده می‌کند. بنابراین در تاریخ ۱۹ فوریه ۲۰۱۷ (اوایل اسفند ۹۵) <a href="https://bugzilla.gnome.org/show_bug.cgi?id=778928">باگ جدیدی</a> ثبت کردم و کار را روی آن شروع کردیم. با کسب تجربه از پیچیدگی‌های باگ قبلی و فرآیند حل آن اینبار با سرعت وارد عمل شدیم (یعنی یکی دو ماه!). هم من یاد گرفته بودم چطور با بچه‌های GTK کار کنم و هم آنها با مشکل راست به چپ نویسی آشنا شده بودند. (مثلا دانیل یاد گرفته بود که خودش متن عربی را تست بکند.)  اول فکر می‌کردیم که باید API ویجت GtkTextView را تغییر بدهیم و همان توابع را در GtkSourceView استفاده کنیم که با واکنش منفی یکی دیگر از برنامه‌نویسان روبرو شد و درخواست کرد که اول تلاش کنیم مشکل را درون GtkSourceView حل کنیم و بار اضافی نگهداری از یک API جدید را به پروژه تحمیل نکنیم. خوشبختانه با مقداری تلاش و همفکری دوستان به <a href="https://bugzilla.gnome.org/attachment.cgi?id=348936&amp;action=diff">پچ جدیدی</a> رسیدیم، حتی خیلی بهتر از پچی که برای GtkTextView نوشته بودیم! پچ به قدری ساده بود که کارها خیلی زود پیش رفت. طبق معمول دوستان اصلاحاتی پیشنهاد کردند که اعمال کردم. مثلا اینکه متن کامیت باید شامل لینک باگزیلا باشد، خط اول آن باید فیکس را شرح بدهد و در بدنه کامیت هم شرح مشکل آمده باشد و در خط آخر هم لینک باگزیلا. خود کد هم باید قواعد رایج GTK و خود ویجت را رعایت کند. مثل تعریف متغیرها در ابتدای کد و استفاده از آکولاد حتی برای بلاک‌های تک خطی و مانند اینها. آزاد کردن اشاره‌گرهای سی هم فراموش نشود!</p>

<p>با این اوصاف باگ دوم بجای سیزده سال در  کمتر از دو ماه حل شد. حتما تصدیق می‌کنید که پیشرفت قابل توجهی است! پچ حلال مشکلات ما را هم می‌توانید در مخزن GTK ‬<a href="https://git.gnome.org/browse/gtksourceview/commit/?id=494c76dd359351b8a703b6aec328126b0f84828b">ببینید</a>. من که بی صبرانه منتظرم تا آرچ لینوکسم را آپدیت بکنم و از این به بعد هرچقدر دلم می‌خواهد در متن‌های فارسی با کنترل و کلیدهای جهت کیبورد به چپ و راست بروم! واقعا چه لذتی از این بالاتر؟ :)</p>

<p>این هم عیدی من به کامیونتی راست به چپ نویسان گنوم باز ایران!</p>

  </article>
  

  <small id="post-tags">
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/gtk.html">gtk</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/gnome.html">gnome</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/%D8%A8%D8%A7%DA%AF.html">باگ</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/%D9%87%D9%85%DA%A9%D8%A7%D8%B1%DB%8C.html">همکاری</a> &nbsp;
    
    <i class="icon-tags"></i>
    <a rel="tag" href="/tag/%D9%BE%DB%8C%DA%AF%DB%8C%D8%B1%DB%8C.html">پیگیری</a> &nbsp;
    
  </small>

  <div style="border-top:1px dotted;">
    <p>
      
      <a href="http://mehdix.ir/github-rtl.html" style="float: left"> راست به چپ نویسی در گیتهاب >> </a>
      

      
      <a href="http://mehdix.ir/patch.html" style="margin-right:0px;">&#60&#60	 پچ بنویس و التماس کن</a>
      
    </p>
  </div>

  
    <!-- An element a visitor can click if they <3 comments! -->
<!--button class="show-comments">نمایش نظرات</button-->

<!-- The empty element required for Disqus to loads comments into -->
<div id="disqus_thread"></div>

<!--script src="//code.jquery.com/jquery-1.11.3.min.js"></script-->
<script src="http://mehdix.ir/assets/js/disqus.js"></script>

<noscript> Please enable JavaScript to view disqus comments. </noscript>

  

</div>
</div>
      </div>
    </section><footer class="site-footer">

  <div class="wrapper">
    <div class="footer-col">
    <img id="gravatar" class="circle" src="http://mehdix.ir/assets/img/me.png" alt="">
    </div>
    <h2 class="footer-heading">معرفی</h2>

    <div class="footer-col-wrapper">
      <!--div class="footer-col  footer-col-1">
      <ul class="contact-list">
      <li>مهدی صادقی</li>
      <li><a href="mailto:sadeghi@mehdix.org"> تماس</a></li>
    </ul>
  </div-->

  <div class="footer-col  footer-col-3">

    <p class="text">بچه که بودیم همیشه برای بازی خونه می‌ساختیم. حالا هم نمونه‌اش رو در وب ساختم. اینجا سکوی انتشار مطالبی در مورد دانش تولید نرم‌افزار و ایده‌ها و علایق شخصی‌ام است، بویژه راه‌حل‌های مهندسی که باعث رشد و پیشرفتم شده است و می‌تواند مورد استفاده دیگران هم قرار بگیرد.
</p>
  </div>
  <div class="footer-col  footer-col-2">
    <ul class="social-media-list">
      
      <li>
        <a href="https://github.com/mehdisadeghi">
          <span class="icon  icon--github">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
            </svg>
          </span>

          <span class="username">پروژه‌ها</span>
        </a>
      </li>
      

      
      <li>
        <a href="https://twitter.com/mehdisadeghii">
          <span class="icon  icon--twitter">
            <svg viewBox="0 0 16 16">
              <path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809
              c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/>
            </svg>
          </span>

          <span class="username">توئیت‌ها</span>
        </a>
      </li>
      <li>
        <a href="https://feedburner.google.com/fb/a/mailverify?uri=mehdixir&amp;loc=en_US"><span class="icon icon--feed">
          <img src="http://mehdix.ir/assets/img/feed_gray_50.png" alt="" />
        </span><span class="username">خبرنامه</span></a>
      </li>
      <li>
        <a href="http://feeds.feedburner.com/mehdixir"><span class="icon icon--feed">
          <img src="http://mehdix.ir/assets/img/feed_gray_50.png" alt=""/>
        </span><span class="username">خوراک</span></a>
      </li>
      <li>
        <span class="icon"><a href="http://validator.w3.org/feed/check.cgi?url=http%3A//mehdix.ir/feed.xml"><img src=http://mehdix.ir/assets/img/valid-atom.png alt="[Valid Atom 1.0]" title="Validate my Atom 1.0 feed" /></a></span>
        <span class="icon"><a href="https://app.wercker.com/project/bykey/7cdfaf1d4ea865468f4965954ed95247"><img src="https://app.wercker.com/status/7cdfaf1d4ea865468f4965954ed95247/s" alt="Build Status" title="wercker status" /></a>
        </span>
      </li>
      
    </ul>
  </div>
</div>
<div id="license" class="textwidget">
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.fa"><img alt="مجوز کریتیو کامنز" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png" /></a><br />
مطالب این وبلاگ تحت مجوز
 <a rel="license" href="http://creativecommons.org/licenses/by/4.0/deed.fa"> 
کریتیو کامنز اتریبیوشن ۴.۰ اینترنشنال </a>قرار دارد.
</div>

</div>
<div  class="center">
  <small style="color:gray">Site generated on Sun, 01 Oct 2017 23:53:30 +0200</small>
</div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-57282325-1', 'auto');
  ga('send', 'pageview');

</script>


</footer>
</div>

<script src="http://mehdix.ir/assets/js/main.js"></script>

</body>

</html>
